---
title: "Next.js App Router 完全指南"
description: "探索 Next.js 13+ 的 App Router 架构和服务器组件"
pubDate: "2023-08-22"
heroImage: "../../assets/blog-placeholder-2.jpg"
---

Next.js 13 引入了革命性的 App Router，基于 React Server Components 构建。

## App Router 基础

新的 `app` 目录提供了更强大的路由系统。

### 文件结构

```
app/
├── layout.tsx      # 根布局
├── page.tsx        # 首页
├── about/
│   └── page.tsx    # /about
└── blog/
    ├── layout.tsx  # 博客布局
    ├── page.tsx    # /blog
    └── [slug]/
        └── page.tsx # /blog/:slug
```

## 服务器组件

默认情况下，所有组件都是服务器组件：

```tsx
// app/blog/page.tsx
async function BlogPage() {
  const posts = await fetch('https://api.example.com/posts')
  const data = await posts.json()
  
  return (
    <div>
      {data.map(post => (
        <article key={post.id}>
          <h2>{post.title}</h2>
        </article>
      ))}
    </div>
  )
}
```

## 客户端组件

使用 `'use client'` 指令：

```tsx
'use client'

import { useState } from 'react'

export function Counter() {
  const [count, setCount] = useState(0)
  
  return (
    <button onClick={() => setCount(count + 1)}>
      Count: {count}
    </button>
  )
}
```

## 数据获取

### 服务器端

```tsx
async function getData() {
  const res = await fetch('https://api.example.com/data', {
    cache: 'force-cache' // SSG
  })
  return res.json()
}

export default async function Page() {
  const data = await getData()
  return <main>{/* ... */}</main>
}
```

### 增量静态再生成 (ISR)

```tsx
fetch('https://api.example.com/data', {
  next: { revalidate: 3600 } // 每小时重新验证
})
```

## 路由组

使用括号创建路由组，不影响 URL：

```
app/
├── (marketing)/
│   ├── about/
│   └── contact/
└── (shop)/
    ├── products/
    └── cart/
```

## 并行路由

```
app/
├── @team/
│   └── page.tsx
├── @analytics/
│   └── page.tsx
└── page.tsx
```

## 总结

App Router 为 Next.js 带来了更强大的功能和更好的性能，是未来 React 应用开发的方向。

